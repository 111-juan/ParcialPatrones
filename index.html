<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Control de Reservas - Restaurante</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- LOGIN SELECCIÓN -->
<div class="container" id="select-login">
  <h2>Bienvenido a La Casa Criolla</h2>
  <div class="button-group">
    <button class="primary" onclick="App.showClientLogin()">Cliente</button>
    <button class="primary" onclick="App.showAdminLogin()">Administrador</button>
  </div>
</div>

<!-- LOGIN CLIENTE -->
<div class="container hidden" id="auth">
  <h2>Iniciar Sesión Cliente</h2>
  <form onsubmit="App.login(event)">
    <label>Nombre o Correo</label>
    <input type="text" id="login-user" required />
    <label>Contraseña</label>
    <input type="password" id="login-pass" required />
    <div class="button-group">
      <button class="primary" type="submit">Ingresar</button>
      <button class="secondary" type="button" onclick="App.showRegister()">Registrarse</button>
      <button class="secondary" type="button" onclick="App.backToSelect()">Volver</button>
    </div>
  </form>
</div>

<!-- LOGIN ADMIN -->
<div class="container hidden" id="admin-auth">
  <h2>Iniciar Sesión Administrador</h2>
  <form onsubmit="App.loginAdmin(event)">
    <label>Usuario</label>
    <input type="text" id="admin-user" required />
    <label>Contraseña</label>
    <input type="password" id="admin-pass" required />
    <div class="button-group">
      <button class="primary" type="submit">Ingresar</button>
      <button class="secondary" type="button" onclick="App.backToSelect()">Volver</button>
    </div>
  </form>
</div>

<!-- REGISTRO -->
<div class="container hidden" id="register">
  <h2>Registro de Usuario</h2>
  <form onsubmit="App.register(event)">
    <label>Nombre</label>
    <input type="text" id="reg-name" required />
    <label>Apellido</label>
    <input type="text" id="reg-lastname" required />
    <label>Cédula</label>
    <input type="text" id="reg-id" oninput="App.validateID(this)" required />
    <label>Correo</label>
    <input type="email" id="reg-email" required />
    <label>Fecha de nacimiento</label>
    <input type="date" id="reg-birth" required />
    <label>Contraseña</label>
    <input type="password" id="reg-pass" required />
    <div class="button-group">
      <button class="primary" type="submit">Registrarme</button>
      <button class="secondary" type="button" onclick="App.showLogin()">Volver</button>
    </div>
  </form>
</div>

<!-- RESERVAS CLIENTE -->
<div class="container hidden" id="main">
  <h2>Bienvenido <span id="user-name"></span></h2>
  <form id="reservation-form" onsubmit="event.preventDefault(); App.generateTicket();">
    <label for="restaurant">Restaurante</label>
    <input type="text" id="restaurant" value="La Casa Criolla" readonly />

    <label for="date">Fecha</label>
    <input type="date" id="date" required />

    <label for="time">Hora</label>
    <select id="time" required>
      <option value="13:00">1:00 PM</option>
      <option value="14:00">2:00 PM</option>
      <option value="15:00">3:00 PM</option>
      <option value="16:00">4:00 PM</option>
      <option value="17:00">5:00 PM</option>
      <option value="18:00">6:00 PM</option>
      <option value="19:00">7:00 PM</option>
      <option value="20:00">8:00 PM</option>
      <option value="21:00">9:00 PM</option>
      <option value="22:00">10:00 PM</option>
    </select>

    <label for="people">Número de personas</label>
    <input type="number" id="people" min="1" max="10" required />

    <label for="table">Mesa</label>
    <input type="text" id="table" readonly />

    <div class="button-group">
      <button class="primary" type="submit">Generar Reserva</button>
      <button class="secondary" type="button" onclick="App.backToSelect()">Volver</button>
    </div>
  </form>
  <div id="ticket" class="hidden"></div>
</div>

<!-- ADMIN PANEL (Próximamente) -->
<div class="container hidden" id="admin-panel">
  <h2>Panel del Administrador</h2>
  <p>Próximamente: ver, modificar y cancelar reservas</p>
</div>

<script>
const App = {
  users: [],
  currentUser: null,
  reservationMade: false,

  showClientLogin() {
    App.hideAll();
    document.getElementById("auth").classList.remove("hidden");
  },

  showAdminLogin() {
    App.hideAll();
    document.getElementById("admin-auth").classList.remove("hidden");
  },

  showRegister() {
    App.hideAll();
    document.getElementById("register").classList.remove("hidden");
  },

  showLogin() {
    App.hideAll();
    document.getElementById("auth").classList.remove("hidden");
  },

  backToSelect() {
    App.hideAll();
    document.getElementById("select-login").classList.remove("hidden");
  },

  hideAll() {
    document.querySelectorAll(".container").forEach(div => div.classList.add("hidden"));
  },

  validateID(input) {
    input.value = input.value.replace(/\D/g, '');
  },

  register(event) {
    event.preventDefault();
    const user = {
      name: document.getElementById("reg-name").value,
      lastname: document.getElementById("reg-lastname").value,
      id: document.getElementById("reg-id").value,
      email: document.getElementById("reg-email").value,
      birth: document.getElementById("reg-birth").value,
      password: document.getElementById("reg-pass").value
    };
    App.users.push(user);
    alert("Registro exitoso. Ahora inicia sesión.");
    App.showLogin();
  },

  login(event) {
    event.preventDefault();
    const userInput = document.getElementById("login-user").value;
    const passInput = document.getElementById("login-pass").value;
    const found = App.users.find(u =>
      (u.name === userInput || u.email === userInput) && u.password === passInput
    );
    if (found) {
      App.currentUser = found;
      document.getElementById("user-name").textContent = found.name;
      App.hideAll();
      document.getElementById("main").classList.remove("hidden");
      App.assignRandomTable();
    } else {
      alert("Credenciales incorrectas.");
    }
  },

  loginAdmin(event) {
    event.preventDefault();
    const adminU = document.getElementById("admin-user").value;
    const adminP = document.getElementById("admin-pass").value;
    if (adminU === "admin" && adminP === "admin123") {
      App.hideAll();
      document.getElementById("admin-panel").classList.remove("hidden");
    } else {
      alert("Usuario o contraseña de administrador incorrectos.");
    }
  },

  generateTicket() {
    if (App.reservationMade) return;

    const restaurant = document.getElementById("restaurant").value;
    const date = document.getElementById("date").value;
    const time = document.getElementById("time").value;
    const people = document.getElementById("people").value;
    const table = document.getElementById("table").value;
    const reservationID = Math.floor(1000 + Math.random() * 9000);

    const ticketDiv = document.getElementById("ticket");
    ticketDiv.innerHTML = `
      <h3>Reserva Generada</h3>
      <p><strong>ID Reserva:</strong> ${reservationID}</p>
      <p><strong>Restaurante:</strong> ${restaurant}</p>
      <p><strong>Fecha:</strong> ${date}</p>
      <p><strong>Hora:</strong> ${time}</p>
      <p><strong>Personas:</strong> ${people}</p>
      <p><strong>Mesa:</strong> ${table}</p>
      <button class="secondary" onclick="App.confirmNew()">Hacer otra reserva</button>
    `;
    ticketDiv.classList.remove("hidden");
    App.reservationMade = true;
  },

  confirmNew() {
    if (confirm("¿Deseas realizar otra reserva?")) {
      document.getElementById("reservation-form").reset();
      document.getElementById("ticket").classList.add("hidden");
      App.reservationMade = false;
      App.assignRandomTable();
    }
  }
};
</script>
</body>
</html>
